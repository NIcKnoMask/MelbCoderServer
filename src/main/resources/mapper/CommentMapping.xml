<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
        "http//mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.unimelbCoder.melbcode.models.dao.CommentDao">
    <select id="getCommentById" resultType="com.unimelbCoder.melbcode.bean.Comment">
        SELECT * FROM comment WHERE id=#{id}
    </select>
    <select id="getCommentByIdxArticle" resultType="com.unimelbCoder.melbcode.bean.Comment">
        SELECT * FROM comment WHERE article_id=#{article_id}
    </select>
    <select id="getCommentByIdxUserId" resultType="com.unimelbCoder.melbcode.bean.Comment">
        SELECT * FROM comment WHERE user_id=#{user_id}
    </select>
    <select id="getTopCommentList" resultType="com.unimelbCoder.melbcode.bean.Comment">
        SELECT * FROM comment WHERE top_comment_id=0 AND article_id=#{article_id} AND deleted=0
    </select>
    <select id="getSubCommentList" resultType="com.unimelbCoder.melbcode.bean.Comment">
        SELECT * FROM comment WHERE top_comment_id=#{top_comment_id} AND article_id=#{article_id} AND deleted=0
    </select>
    <select id="getValidCommentCount" resultType="Integer">
        SELECT COUNT(id) FROM comment WHERE article_id=#{article_id} AND deleted=0
    </select>
    <insert id="createComment" parameterType="com.unimelbCoder.melbcode.bean.Comment">
        INSERT INTO comment (article_id, user_id, content, top_comment_id, parent_comment_id, deleted)
        VALUES (#{article_id}, #{user_id}, #{content}, #{top_comment_id}, #{parent_comment_id}, 0);
    </insert>
</mapper>