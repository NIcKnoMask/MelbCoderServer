<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
        "http//mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.unimelbCoder.melbcode.models.dao.UserDao">
    <select id="getUserByMessage" resultType="com.unimelbCoder.melbcode.bean.User">
        SELECT * FROM users WHERE
        username=#{username} AND password=#{password}
    </select>

    <select id="getUserByName" resultType="com.unimelbCoder.melbcode.bean.User">
        SELECT * FROM users WHERE id=#{id}
    </select>

    <insert id="createUser" parameterType="com.unimelbCoder.melbcode.bean.User">
        INSERT INTO users (id, username, password, email, role, age, introduction)
        VALUES (#{id}, #{username}, #{password}, #{email}, #{role}, #{age}, #{introduction});
    </insert>

    <select id="countByUsername" resultType="int">
        SELECT COUNT(*) FROM users WHERE username=#{username}
    </select>

    <insert id="addReadingHistory" parameterType="map">
        INSERT INTO reading_history (user_id, article_id, visited_count)
        VALUES (#{userId}, #{articleId}, 1)
        ON DUPLICATE KEY UPDATE visited_count = visited_count + 1;
    </insert>
</mapper>